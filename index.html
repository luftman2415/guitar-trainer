<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar Worship Trainer - Elite</title>
    
    <!-- Enlace al archivo de estilos CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Favicon (ícono de la pestaña del navegador) -->
    <link rel="icon" href="logo.svg" type="image/svg+xml">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/midi-writer-js@2.1.6/build/MidiWriter.min.js"></script>
</head>

<body data-theme="light">
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path d="M480.5 176.6c-55.3 2.6-112.7 12.2-152.6 25.4-75.3 25-115.1 69.5-124 138.5-1.6 13.2-1.4 45.5.6 62 3.3 28.1 8 47.4 21.5 87 15 44.3 49.2 115.2 78.8 163.5 16.7 27.3 46.8 70.3 69.6 99.5 35.2 45.1 66.5 74.8 92.4 87.9 16.9 8.5 27 11 44.2 11 11.5 0 15-.4 23.5-2.7 26.6-7.3 52.2-25.1 81.4-56.7 19.7-21.4 31.1-35.6 62.2-77.5 49.5-66.8 99.3-162.1 123.8-236.8 11.2-34.2 15.6-53.8 18.2-81.2 1.4-15.5.6-52.4-1.5-64-8.7-48.7-33.7-84.6-76.6-109.7-38.4-22.5-98.8-37.8-174.5-44.3-17.4-1.5-70.7-2.6-87-1.9zm258.6 161.6 15.9 10.2-4.2 7.6c-14.8 27.2-38.8 60.2-65.7 90.3l-12.8 14.3 8.9 11c16.8 20.7 29.6 39.9 46.7 70.1l9.2 16.2-8.7 12.3c-4.8 6.8-10.5 14.7-12.7 17.7l-3.9 5.3-7.8-15c-14.1-27.1-30.3-53-48.8-77.9l-10.6-14.1-8 7.2c-40.8 36.1-86.4 59.4-133.3 67.8-18.3 3.2-50.3 3.3-67.8 0-24.1-4.5-46.1-12.1-66.4-22.8-36.3-19.2-64.5-44.3-95.1-84.5l-7.9-10.3 2.6-3.6c39.8-53.6 89.2-88.5 141-99.4 52.1-10.9 105.9-2.3 153.9 24.7 25.3 14.2 45.1 29.1 71.6 53.8l11.6 10.9 9.5-10.2c23.7-25.7 40.1-47.7 57.7-77.7 4.5-7.7 8.5-14.1 8.7-14.1.3 0 7.7 4.6 16.4 10.2z"/><path d="M424.6 379.1c-28 4.9-56.6 18.3-80.3 37.5-8.7 7.1-29.3 27.7-29.3 29.3 0 1.3 25.8 26.1 34.3 33 19.1 15.5 43.5 29.3 63.6 36 47.9 15.9 101.3 9.8 149.3-17 16.7-9.4 38.7-25.1 52.3-37.3l4-3.6-8.5-8.1c-42.3-40.4-85.3-63.8-129.4-70.4-14.8-2.2-42-1.9-56 .6z"/></svg>
                <span>Guitar Worship Trainer</span>
            </div>
            <div class="theme-switcher">
                <button class="theme-btn button" data-theme="light" title="Tema Claro">☀️</button>
                <button class="theme-btn button" data-theme="dark" title="Tema Oscuro">🌙</button>
                <button class="theme-btn button" data-theme="ocean" title="Tema Océano">🌊</button>
                <button class="theme-btn button" data-theme="forest" title="Tema Bosque">🌲</button>
            </div>
        </div>
    </header>

    <nav class="nav">
        <div class="nav-content">
            <button class="nav-btn button active" data-section="inicio">🏠 Inicio</button>
            <button class="nav-btn button" data-section="metronome">🥁 Metrónomo</button>
            <button class="nav-btn button" data-section="ear-training">👂 Oído Musical</button>
            <button class="nav-btn button" data-section="songs">🎵 Canciones</button>
            <button class="nav-btn button" data-section="scales">🎸 Escalas</button>
            <button class="nav-btn button" data-section="memory">🧠 Memoria</button>
            <button class="nav-btn button" data-section="recorder">🎙️ Grabadora</button>
        </div>
    </nav>

    <main class="main">
        <section id="inicio" class="section active">
            <div class="welcome">
                <h1>Bienvenido a Guitar Worship Trainer</h1>
                <p>Tu herramienta todo-en-uno para mejorar tus habilidades como músico de adoración.</p>
            </div>
            <div class="cards-grid">
                <div class="card" data-section="metronome"><div class="card-icon">🥁</div><h3>Metrónomo Pro</h3><p>Practica con subdivisiones, patrones de rasgueo y Tap Tempo.</p></div>
                <div class="card" data-section="ear-training"><div class="card-icon">👂</div><h3>Oído Musical</h3><p>Entrena intervalos, acordes y progresiones armónicas.</p></div>
                <div class="card" data-section="songs"><div class="card-icon">🎵</div><h3>Canciones Pro</h3><p>Transporta canciones y visualiza acordes al instante.</p></div>
                <div class="card" data-section="scales"><div class="card-icon">🎸</div><h3>Visualizador de Escalas</h3><p>Aprende cualquier escala en todo el diapasón.</p></div>
                <div class="card" data-section="memory"><div class="card-icon">🧠</div><h3>Memoria Musical</h3><p>Fortalece tu memoria con nuestro juego interactivo de secuencias.</p></div>
            </div>
        </section>

        <section id="metronome" class="section">
            <div class="metronome-controls">
                <div class="bpm-display" id="bpmDisplay">120</div>
                <div class="visual-indicator" id="visualIndicator"></div>
                <div class="control-group">
                    <label for="bpmSlider">Tempo (BPM)</label>
                    <input type="range" id="bpmSlider" class="bpm-slider" min="40" max="240" value="120">
                </div>
                <div class="control-group">
                    <label for="timeSignature">Compás</label>
                    <select id="timeSignature" class="styled-select"><option value="4/4">4/4</option><option value="3/4">3/4</option><option value="2/4">2/4</option><option value="6/8">6/8</option></select>
                </div>
                <div class="control-group">
                    <label for="subdivisionSelect">Subdivisiones</label>
                    <select id="subdivisionSelect" class="styled-select"><option value="1">Negra (1/4)</option><option value="2">Corchea (1/8)</option><option value="4">Semicorchea (1/16)</option></select>
                </div>
                <div class="control-group">
                    <label for="strumPatternSelect">Patrón de Rasgueo</label>
                    <select id="strumPatternSelect" class="styled-select">
                        <option value="">-- Sin Patrón --</option>
                        <option value="basic">Básico (↓ ↓↑ ↑↓↑)</option>
                        <option value="ballad">Balada (↓ ↑↑ ↓↑↑)</option>
                        <option value="custom">Personalizado</option>
                    </select>
                </div>
                <input type="text" id="customStrumPattern" placeholder="Ej: ↓ ↓ ↑ x - ↑" style="display:none; margin-top:0.5em; width:100%;" maxlength="32">
                <div class="control-group">
                    <button id="playBtn" class="play-btn button">▶️ Iniciar</button>
                    <button id="tapTempoBtn" class="button">Tap</button>
                </div>
            </div>
            <div class="backing-track-player" id="backingTrackPlayer">
                <input type="file" id="backingTrackInput" accept="audio/*" style="display:none;">
                <button id="backingLoadBtn" class="button">🎵 Cargar Pista</button>
                <button id="backingPlayPauseBtn" class="button">▶️</button>
                <input type="range" id="backingVolume" min="0" max="1" step="0.01" value="1" style="width:100px;">
                <button id="markA" class="button">Marcar A</button>
                <button id="markB" class="button">Marcar B</button>
                <progress id="backingProgress" value="0" max="1" style="width:180px;vertical-align:middle;"></progress>
                <span id="backingTime" style="margin-left:0.5em;font-variant-numeric:tabular-nums;">00:00 / 00:00</span>
                <span id="backingStatus" style="margin-left:1em;color:var(--text-secondary);"></span>
                <audio id="backingAudio" style="display:none;"></audio>
            </div>
        </section>

        <section id="ear-training" class="section">
            <div class="instrument-selector">
                <label for="instrumentSelect">Selecciona el Instrumento:</label>
                <select id="instrumentSelect" class="styled-select"><option value="piano">🎹 Piano</option><option value="guitar">🎸 Guitarra</option><option value="bass">🎸 Bajo</option></select>
            </div>
            <div class="tabs">
                <button class="tab active" data-tab="intervals">Intervalos</button>
                <button class="tab" data-tab="chords">Acordes</button>
                <button class="tab" data-tab="progressions">Progresiones</button>
            </div>
            <div id="intervals" class="tab-content active">
                <h2>Entrenamiento de Intervalos</h2>
                <div class="exercise-controls"><button class="exercise-btn button" id="newInterval">🎵 Nuevo Intervalo</button><button class="exercise-btn button" id="repeatInterval">🔄 Repetir</button></div>
                <div id="intervalOptions" class="exercise-controls" style="display: none;"></div><div id="intervalResult" style="margin-top: 1rem; font-size: 1.2rem; font-weight: 600;"></div>
            </div>
            <div id="chords" class="tab-content">
                <h2>Entrenamiento de Acordes</h2>
                <div class="exercise-controls"><button class="exercise-btn button" id="newChord">🎹 Nuevo Acorde</button><button class="exercise-btn button" id="repeatChord">🔄 Repetir</button></div>
                <div id="chordOptions" class="exercise-controls" style="display: none;"></div><div id="chordResult" style="margin-top: 1rem; font-size: 1.2rem; font-weight: 600;"></div>
            </div>
            <div id="progressions" class="tab-content">
                <h2>Entrenamiento de Progresiones</h2>
                <div class="exercise-controls"><button class="exercise-btn button" id="newProgression">🎼 Nueva Progresión</button><button class="exercise-btn button" id="repeatProgression">🔄 Repetir</button></div>
                <div id="progressionOptions" class="exercise-controls" style="display: none;"></div><div id="progressionResult" style="margin-top: 1rem; font-size: 1.2rem; font-weight: 600;"></div>
            </div>
        </section>
        
        <section id="songs" class="section">
            <div class="song-manager">
                <h1>🎵 Gestor de Canciones</h1>
                <p style="margin-bottom: 2rem; color: var(--text-secondary);">Gestiona, transporta y visualiza los acordes de tu repertorio.</p>
                <div class="song-controls">
                    <div class="song-selector"><select id="songSelect" class="styled-select"><option value="">Selecciona una canción...</option></select></div>
                    <button class="btn-primary button" id="addSongBtn">➕ Añadir</button>
                    <button class="btn-secondary button" id="importSongsBtn">📥 Importar</button>
                    <button class="btn-secondary button" id="exportSongsBtn">📤 Exportar</button>
                    <button class="btn-secondary button" id="exportMidiBtn">🎹 Exportar a MIDI</button>
                </div>
                <div id="songEmptyState" class="empty-state" style="display: none;">
                    <h3>No hay canciones en tu repertorio</h3>
                    <p>¡Añade tu primera canción o importa una lista para empezar a practicar!</p>
                </div>
                <div id="songDisplay" class="song-display" style="display: none;">
                    <div class="song-header">
                        <div>
                            <h2 id="currentSongTitle"></h2>
                            <p id="currentSongArtist" style="color: var(--text-secondary);"></p>
                        </div>
                        <div class="song-actions">
                            <div class="transpose-controls">
                                <button class="transpose-btn button" id="transposeDown">-1</button>
                                <button class="transpose-btn button" id="transposeUp">+1</button>
                            </div>
                            <button id="deleteSongBtn" class="button" style="display: none;">🗑️</button>
                        </div>
                    </div>
                    <div id="songStructure" class="song-structure"></div>
                </div>
            </div>
        </section>
        
        <section id="scales" class="section">
            <h1 style="text-align:center;">Visualizador de Escalas</h1>
            <div class="scales-controls">
                <select id="rootNoteSelect" class="styled-select">
                    <option value="C">C</option><option value="C#">C# / Db</option><option value="D">D</option><option value="D#">D# / Eb</option><option value="E">E</option><option value="F">F</option><option value="F#">F# / Gb</option><option value="G">G</option><option value="G#">G# / Ab</option><option value="A">A</option><option value="A#">A# / Bb</option><option value="B">B</option>
                </select>
                <select id="scaleTypeSelect" class="styled-select">
                    <option value="major">Mayor</option><option value="minor">menor Natural</option><option value="pentatonic-major">Pentatónica Mayor</option><option value="pentatonic-minor">Pentatónica menor</option><option value="harmonic-minor">menor Armónica</option><option value="mixolydian">Mixolidio</option><option value="dorian">Dórico</option>
                </select>
            </div>
            <div id="fretboardVisualizer"></div>
        </section>

        <section id="memory" class="section">
            <div class="memory-game-container">
                <h1>🧠 Juego de Memoria Musical</h1>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">Repite la secuencia de acordes. ¡Cada nivel es más difícil!</p>
                <div id="memorySequenceDisplay">Pulsa "Iniciar" para empezar</div>
                <div id="memoryOptionsContainer" class="exercise-controls"></div>
                <div id="memoryResult"></div>
                <div class="exercise-controls">
                    <button class="btn-primary button" id="startMemoryGameBtn">▶️ Iniciar Juego</button>
                </div>
            </div>
        </section>

        <section id="recorder" class="section">
            <div class="idea-recorder">
                <h2>🎙️ Grabadora de Ideas Rápida</h2>
                <button id="recBtn" class="rec-btn">● Grabar</button>
                <span id="recTime" class="rec-time">00:00</span>
                <ul id="recList" class="rec-list"></ul>
                <div id="recStatus" class="rec-status"></div>
            </div>
        </section>
    </main>
    
    <input type="file" id="fileInput" accept=".json" style="display: none;">
    <div id="chordTooltip"></div>
    <footer><p>Copyright © <span id="copyright-year"></span> LUFTMANDMAURICIO</p></footer>
    
    <!-- Enlace al archivo JavaScript -->
    <script defer src="main.js"></script>

    <!-- Modal para editor de canciones (se muestra/oculta por JS) -->
    <div id="songModalOverlay" class="song-modal-overlay" style="display:none;">
      <div class="song-modal">
        <button class="close-modal" id="closeSongModalBtn" title="Cerrar">×</button>
        <h2 id="songModalTitle">Nueva Canción</h2>
        <form id="songForm">
          <label for="songTitleInput">Título</label>
          <input type="text" id="songTitleInput" name="title" required maxlength="60" autocomplete="off">
          <label for="songArtistInput">Artista</label>
          <input type="text" id="songArtistInput" name="artist" maxlength="40" autocomplete="off">
          <label for="songStructureInput">Estructura de la Canción</label>
          <textarea id="songStructureInput" name="structure" required placeholder="[Verso 1]\nG C G G\nG G D D\n\n[Coro]\nG C G Em\nG D G G"></textarea>
          <div class="modal-actions">
            <button type="button" class="btn-cancel button" id="cancelSongModalBtn">Cancelar</button>
            <button type="submit" class="btn-save button">Guardar</button>
          </div>
        </form>
      </div>
    </div>
    <!-- Fin modal editor de canciones -->
</body>
</html>